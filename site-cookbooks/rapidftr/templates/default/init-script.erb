# Upstart script for starting RapidFTR Solr and Scheduler

start on filesystem and net-device-up IFACE!=lo
stop on runlevel [016]

post-start script
  cd <%= @release_dir %>
  RAILS_ENV=<%= @rails_env %> bundle exec rake sunspot:solr:start sunspot:reindex
  RAILS_ENV=<%= @rails_env %> bundle exec rake scheduler:restart
end script

pre-stop script
  cd <%= @release_dir %>
  RAILS_ENV=<%= @rails_env %> bundle exec rake sunspot:solr:stop
  RAILS_ENV=<%= @rails_env %> bundle exec rake scheduler:stop
end script
